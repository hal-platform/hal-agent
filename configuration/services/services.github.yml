services:

    github.archive:
        class: 'QL\Hal\Agent\Github\ArchiveApi'
        arguments: ['@github.archive_guzzle', '%github.baseurl.api%']

    github.archive_guzzle:
        class: 'GuzzleHttp\Client'
        arguments:
            -
                headers:
                    Authorization: 'token %github.token%'

    github.references:
        class: 'Github\Api\GitData\References'
        arguments: ['@github.client']

    github.commits:
        class: 'Github\Api\Repository\Commits'
        arguments: ['@github.client']

    github.pullRequests:
        class: 'Github\Api\PullRequest'
        arguments: ['@github.client']

    github.client:
        class: 'QL\Hal\Agent\Github\EnterpriseClient'
        arguments:
            - '@github.client_builder'
            - null
            - '%github.baseurl.site%'
        calls:
            - ['authenticate', ['%github.token%', null, 'http_token']]

    github.client_builder:
        class: 'Github\HttpClient\Builder'
        arguments: ['@github.guzzle_adapter']

    github.guzzle_adapter:
        class: 'Http\Adapter\Guzzle6\Client'
        arguments: ['@github.guzzle']

    github.guzzle:
        class: 'GuzzleHttp\Client'
