services:

    logger:
        class: 'Psr\Log\NullLogger'

    ####################################################################################################################
    # Logging
    ####################################################################################################################

    logger.event:
        class: 'QL\Hal\Agent\Logger\EventLogger'
        arguments:
            - '@doctrine.em'
            - '@logger.event.factory'
            - '@logger.process.handler'
            - '@clock'
    logger.event.factory:
        class: 'QL\Hal\Agent\Logger\EventFactory'
        arguments: ['@doctrine.em', '@doctrine.random']
        calls:
            - ['setRedisHandler', ['@redis']]

    logger.process.handler:
        class: 'QL\Hal\Agent\Logger\ProcessHandler'
        arguments: ['@doctrine.em', '@utility.id.generator']

    ####################################################################################################################
    # mcp logger services
    ####################################################################################################################

    # subscriber to symfony/console event system to prepare mcp logger
    logger.mcp.subscriber:
        class: 'QL\Hal\Agent\Logger\McpLoggerSetupSubscriber'
        arguments: ['@logger.mcp.factory']

    logger.mcp:
        class: 'MCP\Logger\Logger'
        arguments: ['@logger.mcp.service', '@logger.mcp.factory']

    logger.mcp.service:
        class: 'MCP\Logger\Service\Guzzle5Service'
        arguments:
            - '@logger.mcp.guzzle'
            - '@logger.mcp.renderer'
            - '@logger.mcp.url'

    logger.mcp.url:
        class: 'QL\UriTemplate\UriTemplate'
        arguments: ['%logger.mcp.host%']
    logger.mcp.guzzle:
        class: 'GuzzleHttp\Client'
    logger.mcp.renderer:
        class: 'MCP\Logger\Renderer\XmlRenderer'

    logger.mcp.factory:
        class: 'MCP\Logger\Adapter\Psr\MessageFactory'
        arguments: ['@clock']
        calls:
            - ['setDefaultProperty', ['applicationId', '%application.id%']]
