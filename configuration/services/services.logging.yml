services:

    logger:
        class: 'Psr\Log\NullLogger'

    ####################################################################################################################
    # Logging
    ####################################################################################################################

    logger.event:
        class: 'QL\Hal\Agent\Logger\EventLogger'
        arguments:
            - '@doctrine.em'
            - '@logger.event.factory'
            - '@logger.process.handler'
            - '@clock'
    logger.event.factory:
        class: 'QL\Hal\Agent\Logger\EventFactory'
        arguments: ['@doctrine.em', '@doctrine.random']
        calls:
            - ['setRedisHandler', ['@redis']]

    logger.process.handler:
        class: 'QL\Hal\Agent\Logger\ProcessHandler'
        arguments: ['@doctrine.em', '@utility.id.generator']

    ####################################################################################################################
    # mcp logger services
    ####################################################################################################################

    # subscriber to symfony/console event system to prepare mcp logger
    logger.mcp.subscriber:
        class: 'QL\Hal\Agent\Logger\McpLoggerSetupSubscriber'
        arguments: ['@logger.mcp.factory']

    logger.mcp:
        class: 'QL\MCP\Logger\Logger'
        arguments: ['@logger.mcp.service', '@logger.mcp.factory']

    logger.mcp.service:
        class: 'QL\MCP\Logger\Service\GuzzleService'
        arguments:
            - '%logger.mcp.host%'
            - '@logger.mcp.guzzle'
            - '@logger.mcp.xml.serializer'

    logger.mcp.guzzle:
        class: 'GuzzleHttp\Client'

    logger.mcp.xml.serializer:
        class: 'QL\MCP\Logger\Service\Serializer\XMLSerializer'

    logger.mcp.factory:
        class: 'QL\MCP\Logger\Message\MessageFactory'
        arguments: ['@clock']
        calls:
            - ['setDefaultProperty', ['applicationId', '%application.id%']]
