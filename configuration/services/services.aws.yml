services:
    aws.credentials.cache:
        class: 'Guzzle\Cache\DoctrineCacheAdapter'
        arguments: [@aws.credentials.cache.source]
    aws.credentials.cache.source:
        # class: 'Doctrine\Common\Cache\FilesystemCache'
        # arguments: ['/tmp/cache']
        class: 'Doctrine\Common\Cache\ArrayCache'

    aws.eb:
        class: 'Aws\ElasticBeanstalk\ElasticBeanstalkClient'
        factory: ['Aws\ElasticBeanstalk\ElasticBeanstalkClient', 'factory']
        arguments:
            -
                credentials.cache: @aws.credentials.cache
                region: %aws.region%
                key: %aws.credentials.key%
                secret: %aws.credentials.secret%

    aws.s3:
        class: 'Aws\S3\S3Client'
        factory: ['Aws\S3\S3Client', 'factory']
        arguments:
            -
                credentials.cache: @aws.credentials.cache
                region: %aws.region%
                key: %aws.credentials.key%
                secret: %aws.credentials.secret%

    aws.ec2:
        class: 'Aws\Ec2\Ec2Client'
        factory: ['Aws\Ec2\Ec2Client', 'factory']
        arguments:
            -
                credentials.cache: @aws.credentials.cache
                region: %aws.region%
                key: %aws.credentials.key%
                secret: %aws.credentials.secret%
