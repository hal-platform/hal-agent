services:

    ####################################################################################################################
    # lazy commands
    ####################################################################################################################

    lazy.command.build.create:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['build:create', 'command.build.create', @service_container]
    lazy.command.build.build:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['build:build', 'command.build.build', @service_container]
    lazy.command.build.remove:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['build:remove', 'command.build.remove', @service_container]

    lazy.command.push.create:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['push:create', 'command.push.create', @service_container]
    lazy.command.push.push:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['push:push', 'command.push.push', @service_container]

    lazy.command.builds.list:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['builds:list', 'command.builds.list', @service_container]

    lazy.command.worker.build:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['worker:build', 'command.worker.build', @service_container]
    lazy.command.worker.push:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['worker:push', 'command.worker.push', @service_container]

    lazy.command.docker.refresh:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['docker:refresh', 'command.docker.refresh', @service_container]

    lazy.command.server.connections:
        class: 'QL\Hal\Agent\Command\LazyCommand'
        arguments: ['server:connections', 'command.server.connections', @service_container]

    ####################################################################################################################
    # commands
    ####################################################################################################################

    command.build.create:
        class: 'QL\Hal\Agent\Command\CreateBuildCommand'
        arguments:
            - 'build:create'
            - @doctrine.em
            - @clock
            - @build.repo
            - @repository.repo
            - @environment.repo
            - @user.repo
            - @utility.referenceResolver
            - @utility.id.generator
    command.build.build:
        class: 'QL\Hal\Agent\Command\BuildCommand'
        arguments:
            - 'build:build'
            - @logger.event
            - @build.resolver
            - @build.downloader
            - @build.unpacker
            - @build.configuration.reader
            - @build.builder
            - @build.packer
            - @build.mover
            - @utility.helper.downloadProgress
            - @utility.filesystem
            - @ssh.manager
    command.build.remove:
        class: 'QL\Hal\Agent\Command\RemoveBuildCommand'
        arguments:
            - 'build:remove'
            - @doctrine.em
            - @build.repo
            - @utility.filesystem
            - %environment.archive%
    command.builds.list:
        class: 'QL\Hal\Agent\Command\ListBuildsCommand'
        arguments:
            - 'builds:list'
            - @build.repo
            - @repository.repo
            - @environment.repo
            - @utility.filesystem
            - %environment.archive%
    command.push.create:
        class: 'QL\Hal\Agent\Command\CreatePushCommand'
        arguments:
            - 'push:create'
            - @doctrine.em
            - @clock
            - @build.repo
            - @deployment.repo
            - @push.repo
            - @user.repo
            - @utility.id.generator
    command.push.push:
        class: 'QL\Hal\Agent\Command\PushCommand'
        arguments:
            - 'push:push'
            - @logger.event
            - @push.resolver
            - @push.mover
            - @push.unpacker
            - @push.configuration.reader
            - @push.builder
            - @push.deployer
            - @utility.filesystem
            - @utility.github.deploymenter
    command.worker.build:
        class: 'QL\Hal\Agent\Command\Worker\BuildCommand'
        arguments:
            - 'worker:build'
            - 'build:build'
            - @build.repo
            - @doctrine.em
            - @utility.forker
            - @logger.mcp
    command.worker.push:
        class: 'QL\Hal\Agent\Command\Worker\PushCommand'
        arguments:
            - 'worker:push'
            - 'push:push'
            - @push.repo
            - @doctrine.em
            - @utility.forker
            - @logger.mcp

    command.docker.refresh:
        class: 'QL\Hal\Agent\Command\Docker\UpdateSourcesCommand'
        arguments:
            - 'docker:refresh'
            - @ssh.filemanager
            - @utility.process.builder= # = signifies a prototype service
            - @github.archive
            - %environment.temp%
            - %build.unix.remoteUser%
            - %build.unix.server%
            - %docker.source.path%
            - %docker.source.repository%
            - %docker.source.reference%

    command.server.connections:
        class: 'QL\Hal\Agent\Command\Utility\VerifyServerConnectionsCommand'
        arguments:
            - 'server:connections'
            - @server.repo
            - @environment.repo
            - @ssh.manager
            - %push.rsync.remoteUser%
