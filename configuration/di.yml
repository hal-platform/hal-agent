services:

    application:
        class: 'Symfony\Component\Console\Application'
        arguments:
            - '%application.name%'
            - '%application.version%'
        calls:
            - ['add', ['@command.build.create']]
            - ['add', ['@command.build.deploy']]
            - ['add', ['@command.build.list']]
            - ['add', ['@command.build.package']]
            - ['add', ['@command.build.remove']]

    command.build.create:
        class: 'QL\Hal\Agent\Command\CreateBuild'
        arguments:
            - 'build:create'
    command.build.deploy:
        class: 'QL\Hal\Agent\Command\DeployBuild'
        arguments:
            - 'build:deploy'

    command.build.list:
        class: 'QL\Hal\Agent\Command\ListBuilds'
        arguments:
            - 'build:list'

    command.build.package:
        class: 'QL\Hal\Agent\Command\PackageBuild'
        arguments:
            - 'build:package'
    command.build.remove:
        class: 'QL\Hal\Agent\Command\RemoveBuild'
        arguments:
            - 'build:remove'


### imported from hal-core


    # Environment Repository
    environment.repo:
        class: 'QL\Hal\Core\Entity\Repository\EnvironmentRepository'
        factory_service:  doctrine.em
        factory_method:   getRepository
        arguments:
            - 'QL\Hal\Core\Entity\Environment'
    repository.repo:
        class: 'QL\Hal\Core\Entity\Repository\RepositoryRepository'
        factory_service:  doctrine.em
        factory_method:   getRepository
        arguments:
            - 'QL\Hal\Core\Entity\Repository'

    # Doctrine Configuration
    doctrine.config:
        class:            'Doctrine\ORM\Configuration'
        factory_class:    'Doctrine\ORM\Tools\Setup'
        factory_method:   createAnnotationMetadataConfiguration
        arguments:
            - %doctrine.mappings%
            - %doctrine.devmode%

    # Doctrine Entity Manager Configurator
    doctrine.em.config:
        class: 'QL\Hal\Core\Entity\Configurator\EntityManagerConfigurator'

    # Doctrine Entity Manager
    doctrine.em:
        class:            'Doctrine\ORM\EntityManager'
        factory_class:    'Doctrine\ORM\EntityManager'
        factory_method:   create
        arguments:
            - %doctrine.connection%
            - @doctrine.config
        configurator: ['@doctrine.em.config', 'configure']



