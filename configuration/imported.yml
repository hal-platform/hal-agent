imports:
    # These settings are imported from hal-core configuration
    # They should only be loaded for standalone installations
    -
        resource: ../vendor/ql/hal-core/config/di.yml
        # doctrine.em
        # build.repo
        # consumer.repo
        # deployment.repo
        # environment.repo
        # group.repo
        # push.repo
        # repository.repo
        # consumer.repo
        # serverproperty.repo
        # server.repo
        # session.repo
        # subscription.repo
        # user.repo
    -
        resource: config.env.yml

services:

    mcp-logger:
        class: 'MCP\Service\Logger\Logger'
        arguments: ['@mcp-logger.service', '@mcp-logger.factory']
    mcp-logger.service:
        class: 'MCP\Service\Logger\Service\GuzzleService'
        arguments: ['@mcp-logger.guzzle', '@mcp-logger.renderer', true]
    mcp-logger.guzzle:
        class: 'Guzzle\Http\Client'
        arguments: ['http://%mcp-logger.host%:2581/web/core/logentries']

    mcp-logger.renderer:
        class: 'MCP\Service\Logger\Renderer\XmlRenderer'
        arguments: ['@mcp-logger.renderer.writer']
    mcp-logger.renderer.writer:
        class: 'XMLWriter'

    mcp-logger.factory:
        class: 'MCP\Service\Logger\Adapter\Psr\MessageFactory'
        arguments: ['@mcp-logger.factory.clock']
        calls:
          - ['setDefaultProperty', ['applicationId', '%agent.application.id%']]
          - ['setDefaultProperty', ['machineIPAddress', '@mcp-logger.factory.serverIp']]
          - ['setDefaultProperty', ['machineName', 'localhost']]
    mcp-logger.factory.clock:
        class: 'MCP\DataType\Time\Clock'
        arguments: ['now', 'UTC']
    mcp-logger.factory.serverIp:
        class: 'MCP\DataType\IPv4Address'
        factory_class: 'MCP\DataType\IPv4Address'
        factory_method: 'create'
        arguments: ['0.0.0.0']
