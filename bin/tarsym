#!/usr/bin/env php
<?php

$root = __DIR__ . '/..';
require_once $root . '/configuration/bootstrap.php';

$di = \QL\Hal\Agent\Bootstrap\getDi($root);


$start = microtime(true);

$targetFile = '/Users/skluck/Projects/hal-agent/.archive/hal9000-build-qlms1.tar.gz';
$buildPath = '/Users/skluck/Projects/hal-agent/.build/hal9000-build-9804c64bd5240b21b4cf';

$process = $di->get('utility.process.builder')
    ->setWorkingDirectory($buildPath)
    ->setArguments(['tar', '-vczf', $targetFile, '.'])
    ->getProcess();

$process->run();

if ($process->isSuccessful()) {
    echo "\n Success";
} else {
    echo "\n Failure";
}

$elapsed = round(microtime(true) - $start, 3);
echo " in " . $elapsed . " seconds\n";
